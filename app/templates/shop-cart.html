{% extends "base.html" %}
{% load static %}
{% block title %}Shop Cart{% endblock %}
{% block content %}

<main>
   <section class="mb-lg-14 mb-8 mt-8">
      <div class="container">
         <div class="row">
            <div class="col-12">
               <div class="card py-1 border-0 mb-8">
                  <div>
                     <h1 class="fw-bold">Shop Cart</h1>
                  </div>
               </div>
            </div>
         </div>

         <div class="row">
            <!-- ðŸ§º Cart Items -->
            <div class="col-lg-8 col-md-7">
               <div class="py-3">
                  <ul class="list-group list-group-flush">
                     {% for item in items %}
                     <li class="list-group-item py-3 ps-0 border-top">
                        <div class="row align-items-center">
                           <div class="col-6 col-md-6 col-lg-7">
                              <div class="d-flex">
                                 <img src="/media/{{ item.image }}" alt="{{ item.title }}"
                                    class="icon-shape icon-xxl" />
                                 <div class="ms-3">
                                    <a href="{% url 'view-product' item.product_id %}" class="text-inherit">
                                       <h6 class="mb-0">{{ item.title }}</h6>
                                    </a>
                                    <span><small class="text-muted">
                                          â‚¹{{ item.sale_price|default:item.price }}
                                       </small></span>
                                    <div class="mt-2 small lh-1">
                                       <a href="javascript:void(0);" onclick="removeItem({{ item.cart_id }})"
                                          class="text-decoration-none text-inherit">
                                          <span class="me-1 align-text-bottom">
                                             <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14"
                                                viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                                stroke-linecap="round" stroke-linejoin="round"
                                                class="feather feather-trash-2 text-success">
                                                <polyline points="3 6 5 6 21 6"></polyline>
                                                <path
                                                   d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2">
                                                </path>
                                                <line x1="10" y1="11" x2="10" y2="17"></line>
                                                <line x1="14" y1="11" x2="14" y2="17"></line>
                                             </svg>
                                          </span>
                                          <span class="text-muted">Remove</span>
                                       </a>
                                    </div>
                                 </div>
                              </div>
                           </div>

                           <!-- Quantity -->
                           <div class="col-4 col-md-4 col-lg-3">
                              <div class="input-group input-spinner">
                                 <input type="button" value="-" class="button-minus btn btn-sm"
                                    onclick="updateQty({{ item.cart_id }}, -1)" />
                                 <input type="number" step="1" max="10" value="{{ item.quantity }}" readonly
                                    id="qty{{ item.cart_id }}" name="quantity"
                                    class="quantity-field form-control-sm form-input" />
                                 <input type="button" value="+" class="button-plus btn btn-sm"
                                    onclick="updateQty({{ item.cart_id }}, 1)" />
                              </div>
                           </div>

                           <!-- Price -->
                           <div class="col-2 text-lg-end text-start text-md-end col-md-2">
                              <span class="fw-bold">
                                 {% if item.sale_price %}
                                 â‚¹{{ item.sale_price|floatformat:2 }} Ã— {{ item.quantity }} = 
                                 â‚¹{{ item.total_price|floatformat:2 }}
                                 {% else %}
                                 â‚¹{{ item.price|floatformat:2 }} Ã— {{ item.quantity }} = 
                                 â‚¹{{ item.total_price|floatformat:2 }}
                                 {% endif %}
                              </span>


                           </div>
                        </div>
                     </li>
                     {% empty %}
                     <li class="list-group-item text-center py-5">
                        <p class="text-muted mb-0">Your cart is empty ðŸ›’</p>
                        <a href="{% url 'index' %}" class="btn btn-primary mt-3">Continue Shopping</a>
                     </li>
                     {% endfor %}
                  </ul>

                  {% if items %}
                  <div class="d-flex justify-content-between mt-4">
                     <a href="{% url 'index' %}" class="btn btn-primary">Continue Shopping</a>
                  </div>
                  {% endif %}
               </div>
            </div>

            <!-- ðŸ’³ Summary Section -->
            <div class="col-12 col-lg-4 col-md-5">
               <div class="mb-5 card mt-6">
                  <div class="card-body p-6">
                     <h2 class="h5 mb-4">Summary</h2>
                     <div class="card mb-2">
                        <ul class="list-group list-group-flush">
                           <li class="list-group-item d-flex justify-content-between align-items-start">
                              <div class="me-auto">Item Subtotal</div>
                              <span>â‚¹{{ subtotal|floatformat:2 }}</span>
                           </li>

                           <li class="list-group-item d-flex justify-content-between align-items-start">
                              <div class="me-auto">Service Fee</div>
                              <span>â‚¹{{ service_fee|floatformat:2 }}</span>
                           </li>

                           <li class="list-group-item d-flex justify-content-between align-items-start">
                              <div class="me-auto fw-bold">Total</div>
                              <span class="fw-bold">â‚¹{{ total|floatformat:2 }}</span>
                           </li>
                        </ul>
                     </div>

                     {% if items %}
                     <a href="{% url 'cart-checkout' %}" 
   class="btn btn-primary btn-lg d-flex justify-content-between align-items-center">
   Go to Checkout
   <span class="fw-bold">â‚¹{{ total|floatformat:2 }}</span>
</a>

                     {% endif %}

                     <p>
                        <small>
                           By placing your order, you agree to be bound by the Ecom
                           <a href="#">Terms of Service</a> and
                           <a href="#">Privacy Policy</a>.
                        </small>
                     </p>

                     
                  </div>
               </div>
            </div>
         </div>
      </div>
   </section>
</main>

{% endblock %}